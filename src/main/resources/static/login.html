<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="css/index.css">
    <title>PMNote后台系统</title>

<style>
  .el-row {
    margin-bottom: 20px;
    &:last-child {
      margin-bottom: 0;
    }
  },
#app{
    display: flex;
    width: 400px;
    height: 250px;
    background:#dddddd;
    border:2px solid #a1a1a1;
}

</style>

</head>
<body>
<div id="app" >
    <el-row>
        <el-col :span="8"><el-input v-model="username" placeholder="用户名"></el-input></el-col>
    </el-row>

    <el-row>
        <el-col :span="8"><el-input v-model="pwd" placeholder="密码" type="password" ></el-input></el-col>
    </el-row>

    <el-row>
        <el-button @click="submit()" type="primary" >登录</el-button>
    </el-row>
</div>
</body>


<!-- import Vue before Element -->
<script src="lib/vue.js"></script>
<script src="lib/vue-resource.min.js"></script>
<!-- import JavaScript -->
<script src="lib/index.js"></script>
<script>
    var app = new Vue({
      el: '#app',

      data:{
        username:"",
        pwd:""
      },

      methods:{
        submit:function(){
            if(!checkForm())
                return

            this.$http.post('/api/dologin',
            {
                username:this.username,
                pwd: this.pwd
            }
            ,{emulateJSON:true})
            .then(
                function onSuccess(res){
                    console.log(res);
                    //alert(res.body)
                    //var json=JSON.parse(res.body)
                    //console.log(json)

                    if(res.body === null){
                        alert('登录失败')
                        return
                    }

                    //console.log("data = " + res.body.data)
                    //console.log(res.body.data.username)
                    if(res.body.code === 200){
                        //alert('登录成功')
                        window.location = "/page/index";
                        return
                    }
                    alert('登录失败')
                },

                function onError(res){
                    //console.log(res);
                    alert('登录失败')
                })
        },

      }
    })

    function checkForm(){
        if(app.username === ''){
            alert('用户名为空')
            return false
        }

        if(app.pwd === ''){
            alert('密码为空')
            return false
        }

        return true
    }

  </script>
</html>